<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="de">
<head>
<!-- Generated by javadoc (1.8.0_252) on Mon Aug 03 19:07:36 CEST 2020 -->
<title>TR_03111_Utils</title>
<meta name="date" content="2020-08-03">
<link rel="stylesheet" type="text/css" href="../../../../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="TR_03111_Utils";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":9,"i1":9,"i2":9,"i3":9,"i4":9,"i5":9};
var tabs = {65535:["t0","All Methods"],1:["t1","Static Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/TR_03111_Utils.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../../main/java/de/bsi/tsesimulator/utils/TARUtils.html" title="class in main.java.de.bsi.tsesimulator.utils"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../../../main/java/de/bsi/tsesimulator/utils/Utils.html" title="class in main.java.de.bsi.tsesimulator.utils"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../../index.html?main/java/de/bsi/tsesimulator/utils/TR_03111_Utils.html" target="_top">Frames</a></li>
<li><a href="TR_03111_Utils.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">main.java.de.bsi.tsesimulator.utils</div>
<h2 title="Class TR_03111_Utils" class="title">Class TR_03111_Utils</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>main.java.de.bsi.tsesimulator.utils.TR_03111_Utils</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>public class <span class="typeNameLabel">TR_03111_Utils</span>
extends java.lang.Object</pre>
<div class="block">Implementations of functions mentioned in BSI TR-03111.</div>
<dl>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.0</dd>
<dt><span class="simpleTagLabel">Author:</span></dt>
<dd>dpottkaemper</dd>
</dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier</th>
<th class="colLast" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private </code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../main/java/de/bsi/tsesimulator/utils/TR_03111_Utils.html#TR_03111_Utils--">TR_03111_Utils</a></span>()</code>
<div class="block">Class only provides static methods, therefore should not be instantiated.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t1" class="tableTab"><span><a href="javascript:show(1);">Static Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>static byte[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../main/java/de/bsi/tsesimulator/utils/TR_03111_Utils.html#FE2OS-java.math.BigInteger-java.math.BigInteger-">FE2OS</a></span>(java.math.BigInteger&nbsp;fieldElementCoordinate,
     java.math.BigInteger&nbsp;p)</code>
<div class="block">An interpretation of the TR-03111 FE2OS function.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>static byte[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../main/java/de/bsi/tsesimulator/utils/TR_03111_Utils.html#I2OS-java.math.BigInteger-int-">I2OS</a></span>(java.math.BigInteger&nbsp;x,
    int&nbsp;length)</code>
<div class="block">Overloaded variant of <a href="../../../../../../main/java/de/bsi/tsesimulator/utils/TR_03111_Utils.html#I2OS-int-int-">I2OS(int, int)</a> used to deal with BigIntegers as they appear in field elements.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>static byte[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../main/java/de/bsi/tsesimulator/utils/TR_03111_Utils.html#I2OS-int-int-">I2OS</a></span>(int&nbsp;x,
    int&nbsp;length)</code>
<div class="block">Interpretation of the TR-03111 I2OS.</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>static java.math.BigInteger</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../main/java/de/bsi/tsesimulator/utils/TR_03111_Utils.html#OS2BigInt-byte:A-">OS2BigInt</a></span>(byte[]&nbsp;octetString)</code>
<div class="block">A version of the TR-03111 OS2I method but it returns BigIntegers.</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>static java.math.BigInteger</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../main/java/de/bsi/tsesimulator/utils/TR_03111_Utils.html#OS2FE-byte:A-java.math.BigInteger-">OS2FE</a></span>(byte[]&nbsp;fieldElementOS,
     java.math.BigInteger&nbsp;p)</code>
<div class="block">An interpretation of the TR-03111 OS2FE function.</div>
</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code>static byte[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../main/java/de/bsi/tsesimulator/utils/TR_03111_Utils.html#truncatedleftmostBits-byte:A-int-">truncatedleftmostBits</a></span>(byte[]&nbsp;originalValue,
                     int&nbsp;leftmostBitsCount)</code>
<div class="block">Truncates the contents of a byte array to its x leftmost bits where x is determined by the value of leftmostBitsCount.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="TR_03111_Utils--">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>TR_03111_Utils</h4>
<pre>private&nbsp;TR_03111_Utils()</pre>
<div class="block">Class only provides static methods, therefore should not be instantiated.</div>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="I2OS-java.math.BigInteger-int-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>I2OS</h4>
<pre>public static&nbsp;byte[]&nbsp;I2OS(java.math.BigInteger&nbsp;x,
                          int&nbsp;length)
                   throws <a href="../../../../../../main/java/de/bsi/tsesimulator/exceptions/TR_03111_ECC_V2_1_Exception.html" title="class in main.java.de.bsi.tsesimulator.exceptions">TR_03111_ECC_V2_1_Exception</a></pre>
<div class="block">Overloaded variant of <a href="../../../../../../main/java/de/bsi/tsesimulator/utils/TR_03111_Utils.html#I2OS-int-int-">I2OS(int, int)</a> used to deal with BigIntegers as they appear in field elements. <br> Pads from the left with zeroes if necessary.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>x</code> - a positive BigInteger to be converted.</dd>
<dd><code>length</code> - the desired length of the octet string.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>an octet string representation of x.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../../../../main/java/de/bsi/tsesimulator/exceptions/TR_03111_ECC_V2_1_Exception.html" title="class in main.java.de.bsi.tsesimulator.exceptions">TR_03111_ECC_V2_1_Exception</a></code> - if x is negative or the desired length of the octet string is too short for x.</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.0</dd>
</dl>
</li>
</ul>
<a name="I2OS-int-int-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>I2OS</h4>
<pre>public static&nbsp;byte[]&nbsp;I2OS(int&nbsp;x,
                          int&nbsp;length)
                   throws <a href="../../../../../../main/java/de/bsi/tsesimulator/exceptions/TR_03111_ECC_V2_1_Exception.html" title="class in main.java.de.bsi.tsesimulator.exceptions">TR_03111_ECC_V2_1_Exception</a></pre>
<div class="block">Interpretation of the TR-03111 I2OS. <br> Takes an int as input and returns a byte array.<br> Might pad with zeroes from the left if necessary.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>x</code> - - the positive integer that shall be converted.</dd>
<dd><code>length</code> - -  the desired length of the octet string.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>an octet string that represents the converted integer with the MSB at position 0.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../../../../main/java/de/bsi/tsesimulator/exceptions/TR_03111_ECC_V2_1_Exception.html" title="class in main.java.de.bsi.tsesimulator.exceptions">TR_03111_ECC_V2_1_Exception</a></code></dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.0</dd>
</dl>
</li>
</ul>
<a name="OS2BigInt-byte:A-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>OS2BigInt</h4>
<pre>public static&nbsp;java.math.BigInteger&nbsp;OS2BigInt(byte[]&nbsp;octetString)</pre>
<div class="block">A version of the TR-03111 OS2I method but it returns BigIntegers.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>octetString</code> - - a byte array containing the most significant byte at position 0 and the least significant byte at position octetString.length-1</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>- a positive BigInteger representing the octet string</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.0</dd>
</dl>
</li>
</ul>
<a name="FE2OS-java.math.BigInteger-java.math.BigInteger-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>FE2OS</h4>
<pre>public static&nbsp;byte[]&nbsp;FE2OS(java.math.BigInteger&nbsp;fieldElementCoordinate,
                           java.math.BigInteger&nbsp;p)</pre>
<div class="block">An interpretation of the TR-03111 FE2OS function. <br> Uses the <a href="../../../../../../main/java/de/bsi/tsesimulator/utils/TR_03111_Utils.html#I2OS-java.math.BigInteger-int-">I2OS(BigInteger, int)</a> method, more precise:<br>
 Field element x e Fp is converted to octet string of length l = roundedUp(log256(p))
 with the function I2OS(x, l) where x is represented as an integer</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>fieldElementCoordinate</code> - - coordinate of an ECPoint</dd>
<dd><code>p</code> - - the prime p that generates the field Fp</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>- the octet string representation of the fieldElementCoordinate</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.0</dd>
</dl>
</li>
</ul>
<a name="OS2FE-byte:A-java.math.BigInteger-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>OS2FE</h4>
<pre>public static&nbsp;java.math.BigInteger&nbsp;OS2FE(byte[]&nbsp;fieldElementOS,
                                         java.math.BigInteger&nbsp;p)</pre>
<div class="block">An interpretation of the TR-03111 OS2FE function. <br> Uses the <a href="../../../../../../main/java/de/bsi/tsesimulator/utils/TR_03111_Utils.html#OS2BigInt-byte:A-">OS2BigInt(byte[])</a> method.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>fieldElementOS</code> - - octet string representing a field element coordinate</dd>
<dd><code>p</code> - - the prime that generates the field Fp</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>- the BigInteger representing a coordinate of a field element</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.0</dd>
</dl>
</li>
</ul>
<a name="truncatedleftmostBits-byte:A-int-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>truncatedleftmostBits</h4>
<pre>public static&nbsp;byte[]&nbsp;truncatedleftmostBits(byte[]&nbsp;originalValue,
                                           int&nbsp;leftmostBitsCount)</pre>
<div class="block">Truncates the contents of a byte array to its x leftmost bits where x is determined by the value of leftmostBitsCount.<br>
 To achieve this, the method calculates how many bytes are needed and returns a cropped byte array.<br>
 It does pad the byte array with zeroes from the left if it is too short. However, if this method is called by
 ECDSA or <a href="../../../../../../main/java/de/bsi/tsesimulator/tse/crypto/ECSDSA.html" title="class in main.java.de.bsi.tsesimulator.tse.crypto">ECSDSA</a> they should have checked if it is legal to call the function.
 It would be illegal for them to call this function if the bit length of the output of the hash function used by a <a href="../../../../../../main/java/de/bsi/tsesimulator/tse/crypto/SignatureAlgorithm.html" title="class in main.java.de.bsi.tsesimulator.tse.crypto">SignatureAlgorithm</a>
 was smaller than the bit length of the order of the EC base point.
 So, if an ECDSA or an ECSDSA calls this method, the case <b> originalValue.length < ((leftmostBitsCount + 7) / 8) </b> should never occur.
 
 <br><br> <b>Note:</b> currently, the case "(originalValue bitcount < leftmostBitsCount) && ((leftmostBitsCount % 8) != 0)"
 is not covered.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>originalValue</code> - the byte array to be cropped or padded.</dd>
<dd><code>leftmostBitsCount</code> - the number of bits that shall be returned beginning at the MSB (position zero) of the byte array.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>a byte array containing x leftmost bits of the original byte array. If leftmostBitsCount was bigger than the number of bits
 in the originalValue, the returned byte array is padded with zeroes from the left and then the bits from the originalValue
 follow.</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.0</dd>
</dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/TR_03111_Utils.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../../main/java/de/bsi/tsesimulator/utils/TARUtils.html" title="class in main.java.de.bsi.tsesimulator.utils"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../../../main/java/de/bsi/tsesimulator/utils/Utils.html" title="class in main.java.de.bsi.tsesimulator.utils"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../../index.html?main/java/de/bsi/tsesimulator/utils/TR_03111_Utils.html" target="_top">Frames</a></li>
<li><a href="TR_03111_Utils.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
