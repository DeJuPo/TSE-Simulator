<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="de">
<head>
<!-- Generated by javadoc (1.8.0_252) on Mon Aug 03 19:07:37 CEST 2020 -->
<title>PersistentStorage</title>
<meta name="date" content="2020-08-03">
<link rel="stylesheet" type="text/css" href="../../../../../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="PersistentStorage";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":10,"i1":10,"i2":10,"i3":10,"i4":10,"i5":10,"i6":10,"i7":10};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/PersistentStorage.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../../../main/java/de/bsi/tsesimulator/tse/storage/PersistedValues.html" title="class in main.java.de.bsi.tsesimulator.tse.storage"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../../../../main/java/de/bsi/tsesimulator/tse/storage/Storage.html" title="class in main.java.de.bsi.tsesimulator.tse.storage"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../../../index.html?main/java/de/bsi/tsesimulator/tse/storage/PersistentStorage.html" target="_top">Frames</a></li>
<li><a href="PersistentStorage.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">main.java.de.bsi.tsesimulator.tse.storage</div>
<h2 title="Class PersistentStorage" class="title">Class PersistentStorage</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>main.java.de.bsi.tsesimulator.tse.storage.PersistentStorage</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>public class <span class="typeNameLabel">PersistentStorage</span>
extends java.lang.Object</pre>
<div class="block">Stores the values that the TSE needs when it is started. For example, it stores the time when the TSE simulator is shut down correctly.
 The path it stores the values in can be specified through the config.properties file. The last values are <b>always</b> saved to a file
 named persistentValues.
 Values are stored through the creation of a Java Object (<a href="../../../../../../../main/java/de/bsi/tsesimulator/tse/storage/PersistedValues.html" title="class in main.java.de.bsi.tsesimulator.tse.storage">PersistedValues</a> and the serialization of that object.
 
 <br><br>Is responsible for finding the user data as well, e.g. comparing the PIN and the PUK that is entered to the ones stored in a file.</div>
<dl>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.0</dd>
<dt><span class="simpleTagLabel">Version:</span></dt>
<dd>1.5</dd>
<dt><span class="simpleTagLabel">Author:</span></dt>
<dd>dpottkaemper</dd>
</dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../../main/java/de/bsi/tsesimulator/tse/storage/PersistentStorage.html#pathToPersistentStorageDir">pathToPersistentStorageDir</a></span></code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../../../../../main/java/de/bsi/tsesimulator/tse/storage/PersistentStorage.html#PersistentStorage--">PersistentStorage</a></span>()</code>
<div class="block">Default constructor for a PersistentStorage object.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../../main/java/de/bsi/tsesimulator/tse/storage/PersistentStorage.html#addUser-main.java.de.bsi.tsesimulator.tse.usermanagement.User-">addUser</a></span>(<a href="../../../../../../../main/java/de/bsi/tsesimulator/tse/usermanagement/User.html" title="class in main.java.de.bsi.tsesimulator.tse.usermanagement">User</a>&nbsp;newUser)</code>
<div class="block">Attempts to add a user to the simulator and create an entry for it in the userlist.properties file and the persistentStorageDir.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../../main/java/de/bsi/tsesimulator/tse/storage/PersistentStorage.html#deletePersistedValues--">deletePersistedValues</a></span>()</code>
<div class="block">Deletes persisted values for the simulator.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code><a href="../../../../../../../main/java/de/bsi/tsesimulator/tse/storage/PersistedValues.html" title="class in main.java.de.bsi.tsesimulator.tse.storage">PersistedValues</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../../main/java/de/bsi/tsesimulator/tse/storage/PersistentStorage.html#loadFromPersistedFile--">loadFromPersistedFile</a></span>()</code>
<div class="block">Used to load the previously persisted values from the persistentValues.ser file.</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code><a href="../../../../../../../main/java/de/bsi/tsesimulator/tse/usermanagement/User.html" title="class in main.java.de.bsi.tsesimulator.tse.usermanagement">User</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../../main/java/de/bsi/tsesimulator/tse/storage/PersistentStorage.html#loadUser-java.lang.String-">loadUser</a></span>(java.lang.String&nbsp;userId)</code>
<div class="block">This method loads a <a href="../../../../../../../main/java/de/bsi/tsesimulator/tse/usermanagement/User.html" title="class in main.java.de.bsi.tsesimulator.tse.usermanagement">User</a> from a file in the directory specified by persistentStorageDir in config.properties.</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../../main/java/de/bsi/tsesimulator/tse/storage/PersistentStorage.html#persistentValuesExist--">persistentValuesExist</a></span>()</code>
<div class="block">Searches for a file named "persistentValues.ser" in the path that leads to the directory storing persistent values.</div>
</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../../main/java/de/bsi/tsesimulator/tse/storage/PersistentStorage.html#removeUser-java.lang.String-">removeUser</a></span>(java.lang.String&nbsp;deleteUserId)</code>
<div class="block">Removes a <a href="../../../../../../../main/java/de/bsi/tsesimulator/tse/usermanagement/User.html" title="class in main.java.de.bsi.tsesimulator.tse.usermanagement">User</a> from both the persistentStorageDir and the userlist.properties file.</div>
</td>
</tr>
<tr id="i6" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../../main/java/de/bsi/tsesimulator/tse/storage/PersistentStorage.html#storeLatestValues-long-boolean-boolean-long-long-java.lang.String-">storeLatestValues</a></span>(long&nbsp;cryptoCoreClockStatus,
                 boolean&nbsp;tseIsInitialized,
                 boolean&nbsp;seIsDisabled,
                 long&nbsp;sigCntr,
                 long&nbsp;transactionCntr,
                 java.lang.String&nbsp;descriptionOfSEAPI)</code>
<div class="block">Persists the values that shall be loaded in on start of the TSE simulator.</div>
</td>
</tr>
<tr id="i7" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../../main/java/de/bsi/tsesimulator/tse/storage/PersistentStorage.html#writeModifiedUserdataToStorage-main.java.de.bsi.tsesimulator.tse.usermanagement.User-">writeModifiedUserdataToStorage</a></span>(<a href="../../../../../../../main/java/de/bsi/tsesimulator/tse/usermanagement/User.html" title="class in main.java.de.bsi.tsesimulator.tse.usermanagement">User</a>&nbsp;modifiedUser)</code>
<div class="block">Used to update the parameters that describe a certain user.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="pathToPersistentStorageDir">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>pathToPersistentStorageDir</h4>
<pre>private&nbsp;java.lang.String pathToPersistentStorageDir</pre>
</li>
</ul>
</li>
</ul>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="PersistentStorage--">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>PersistentStorage</h4>
<pre>public&nbsp;PersistentStorage()
                  throws <a href="../../../../../../../main/java/de/bsi/tsesimulator/exceptions/LoadingFailedException.html" title="class in main.java.de.bsi.tsesimulator.exceptions">LoadingFailedException</a></pre>
<div class="block">Default constructor for a PersistentStorage object. It uses <a href="../../../../../../../main/java/de/bsi/tsesimulator/preferences/PropertyValues.html#getPathToPersistentStorage--">PropertyValues.getPathToPersistentStorage()</a> to fetch the path to the directory used 
 as persistent storage. Due to how <a href="../../../../../../../main/java/de/bsi/tsesimulator/preferences/PropertyValues.html" title="class in main.java.de.bsi.tsesimulator.preferences">PropertyValues</a> builds the path and accesses the configuration file, it is necessary, that <a href="../../../../../../../main/java/de/bsi/tsesimulator/preferences/PropertyValues.html#setPathToResourceDirectory-java.lang.String-">PropertyValues.setPathToResourceDirectory(String)</a>
  has been called beforehand.</div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../../../../../main/java/de/bsi/tsesimulator/exceptions/LoadingFailedException.html" title="class in main.java.de.bsi.tsesimulator.exceptions">LoadingFailedException</a></code> - if constructing the path in <a href="../../../../../../../main/java/de/bsi/tsesimulator/preferences/PropertyValues.html" title="class in main.java.de.bsi.tsesimulator.preferences">PropertyValues</a> fails.</dd>
</dl>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="persistentValuesExist--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>persistentValuesExist</h4>
<pre>public&nbsp;boolean&nbsp;persistentValuesExist()</pre>
<div class="block">Searches for a file named "persistentValues.ser" in the path that leads to the directory storing persistent values.
 If the file exists, it was likely created by this class.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>true, if the persistentValues file in the persistentStorageDir exists. False otherwise.</dd>
</dl>
</li>
</ul>
<a name="storeLatestValues-long-boolean-boolean-long-long-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>storeLatestValues</h4>
<pre>public&nbsp;void&nbsp;storeLatestValues(long&nbsp;cryptoCoreClockStatus,
                              boolean&nbsp;tseIsInitialized,
                              boolean&nbsp;seIsDisabled,
                              long&nbsp;sigCntr,
                              long&nbsp;transactionCntr,
                              java.lang.String&nbsp;descriptionOfSEAPI)
                       throws <a href="../../../../../../../main/java/de/bsi/tsesimulator/exceptions/PersistingFailedException.html" title="class in main.java.de.bsi.tsesimulator.exceptions">PersistingFailedException</a></pre>
<div class="block">Persists the values that shall be loaded in on start of the TSE simulator.
 Checks if a persistence file is already present. If there is, it is de-serialized from the file and the values are checked.
 If for example the new signature counter is less than the old signature counter, there is an error and this is not persisted.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>cryptoCoreClockStatus</code> - the time of the clock of the CryptoCore in Unix time at the moment the method was called.</dd>
<dd><code>tseIsInitialized</code> - the initialization status of the TSE.</dd>
<dd><code>seIsDisabled</code> - the status of the secure element at the time of the method call.</dd>
<dd><code>sigCntr</code> - the signature counter at the time of the method call.</dd>
<dd><code>transactionCntr</code> - the transaction number at the time of the method call</dd>
<dd><code>descriptionOfSEAPI</code> - the description of the SE API set inside the TSE</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../../../../../main/java/de/bsi/tsesimulator/exceptions/PersistingFailedException.html" title="class in main.java.de.bsi.tsesimulator.exceptions">PersistingFailedException</a></code> - if the serialization or de-serialization of a file fails. is also thrown if a file reference
 is not found or an IOException occurs.</dd>
</dl>
</li>
</ul>
<a name="loadFromPersistedFile--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>loadFromPersistedFile</h4>
<pre>public&nbsp;<a href="../../../../../../../main/java/de/bsi/tsesimulator/tse/storage/PersistedValues.html" title="class in main.java.de.bsi.tsesimulator.tse.storage">PersistedValues</a>&nbsp;loadFromPersistedFile()
                                      throws <a href="../../../../../../../main/java/de/bsi/tsesimulator/exceptions/LoadingFailedException.html" title="class in main.java.de.bsi.tsesimulator.exceptions">LoadingFailedException</a></pre>
<div class="block">Used to load the previously persisted values from the persistentValues.ser file.
 <a href="../../../../../../../main/java/de/bsi/tsesimulator/tse/storage/PersistentStorage.html#persistentValuesExist--">persistentValuesExist()</a> should be called beforehand.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the values retrieved from the persisted file.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../../../../../main/java/de/bsi/tsesimulator/exceptions/LoadingFailedException.html" title="class in main.java.de.bsi.tsesimulator.exceptions">LoadingFailedException</a></code> - if loading the persisted file fails for any reason</dd>
</dl>
</li>
</ul>
<a name="deletePersistedValues--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>deletePersistedValues</h4>
<pre>public&nbsp;void&nbsp;deletePersistedValues()</pre>
<div class="block">Deletes persisted values for the simulator. Is only useful in the TSE-Simulator context, should not be implemented in a real TSE.
 <br>Does not delete any user related files! Use the separate method <a href="../../../../../../../main/java/de/bsi/tsesimulator/tse/TSEController.html#removeAllUsersFromSimulator--">TSEController.removeAllUsersFromSimulator()</a> to delete all users.</div>
</li>
</ul>
<a name="addUser-main.java.de.bsi.tsesimulator.tse.usermanagement.User-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>addUser</h4>
<pre>public&nbsp;void&nbsp;addUser(<a href="../../../../../../../main/java/de/bsi/tsesimulator/tse/usermanagement/User.html" title="class in main.java.de.bsi.tsesimulator.tse.usermanagement">User</a>&nbsp;newUser)
             throws <a href="../../../../../../../main/java/de/bsi/tsesimulator/exceptions/TooManyUsersException.html" title="class in main.java.de.bsi.tsesimulator.exceptions">TooManyUsersException</a>,
                    java.lang.IllegalArgumentException,
                    <a href="../../../../../../../main/java/de/bsi/tsesimulator/exceptions/AddingUserFailedException.html" title="class in main.java.de.bsi.tsesimulator.exceptions">AddingUserFailedException</a>,
                    <a href="../../../../../../../main/java/de/bsi/tsesimulator/exceptions/UserAlreadyExistsException.html" title="class in main.java.de.bsi.tsesimulator.exceptions">UserAlreadyExistsException</a></pre>
<div class="block">Attempts to add a user to the simulator and create an entry for it in the userlist.properties file and the persistentStorageDir.
 All user data files are named "UserID_xyz_.dat" and contain the user data as a Java serialized file.<br>
 Please note, this is a feature that is not described in TR-03151 and is only featured for the sake of simulating a TSE. Without the ability to add and 
 and remove users, one would only be able to use users that were added in the production process of the simulator.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>newUser</code> - the user to be added to the simulator with all its parameters set.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../../../../../main/java/de/bsi/tsesimulator/exceptions/TooManyUsersException.html" title="class in main.java.de.bsi.tsesimulator.exceptions">TooManyUsersException</a></code> - if the number of users would exceed <a href="../../../../../../../main/java/de/bsi/tsesimulator/constants/Constants.html#MAX_STORED_USERS">Constants.MAX_STORED_USERS</a> if the newUser was added.</dd>
<dd><code><a href="../../../../../../../main/java/de/bsi/tsesimulator/exceptions/UserAlreadyExistsException.html" title="class in main.java.de.bsi.tsesimulator.exceptions">UserAlreadyExistsException</a></code> - the user seems to already exists, whether this is in the userlist.properties or in the persistentStorageDir</dd>
<dd><code>java.lang.IllegalArgumentException</code> - the userId or the role did not match the requirements. The ID has to be an ASN1 PrintableString and max
 <a href="../../../../../../../main/java/de/bsi/tsesimulator/constants/Constants.html#MAX_USERID_LENGTH">Constants.MAX_USERID_LENGTH</a> long and the role has to be admin or timeAdmin.</dd>
<dd><code><a href="../../../../../../../main/java/de/bsi/tsesimulator/exceptions/AddingUserFailedException.html" title="class in main.java.de.bsi.tsesimulator.exceptions">AddingUserFailedException</a></code> - if for any reason the attempt to write the user to a user data file fails. Most common cause
 are IOExceptions.</dd>
</dl>
</li>
</ul>
<a name="writeModifiedUserdataToStorage-main.java.de.bsi.tsesimulator.tse.usermanagement.User-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>writeModifiedUserdataToStorage</h4>
<pre>public&nbsp;void&nbsp;writeModifiedUserdataToStorage(<a href="../../../../../../../main/java/de/bsi/tsesimulator/tse/usermanagement/User.html" title="class in main.java.de.bsi.tsesimulator.tse.usermanagement">User</a>&nbsp;modifiedUser)
                                    throws <a href="../../../../../../../main/java/de/bsi/tsesimulator/exceptions/ModifyingUserFailedException.html" title="class in main.java.de.bsi.tsesimulator.exceptions">ModifyingUserFailedException</a>,
                                           java.lang.IllegalArgumentException</pre>
<div class="block">Used to update the parameters that describe a certain user. This is used for resetting the number of retries and modifying the PIN and PUK.
 Called by the <a href="../../../../../../../main/java/de/bsi/tsesimulator/tse/TSEController.html" title="class in main.java.de.bsi.tsesimulator.tse">TSEController</a> in methods such as <a href="../../../../../../../main/java/de/bsi/tsesimulator/tse/TSEController.html#unblockUser-java.lang.String-byte:A-byte:A-main.java.de.bsi.seapi.holdertypes.UnblockResultHolder-">TSEController.unblockUser(String, byte[], byte[], main.java.de.bsi.seapi.holdertypes.UnblockResultHolder)</a>.
 The method checks, whether the caller is trying to modify the role of the user but other necessary checks are to be performed by the caller.
 This includes checking if the number of remaining retries is legal and that the PIN and PUK have the necessary length.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>modifiedUser</code> - the <a href="../../../../../../../main/java/de/bsi/tsesimulator/tse/usermanagement/User.html" title="class in main.java.de.bsi.tsesimulator.tse.usermanagement">User</a> whose updated values shall be stored</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../../../../../main/java/de/bsi/tsesimulator/exceptions/ModifyingUserFailedException.html" title="class in main.java.de.bsi.tsesimulator.exceptions">ModifyingUserFailedException</a></code> - if modifying the user data fails due to IOExceptions or due to illegal operations</dd>
<dd><code>java.lang.IllegalArgumentException</code> - the userId or the role did not match the requirements. The ID has to be an ASN1 PrintableString and max
 <a href="../../../../../../../main/java/de/bsi/tsesimulator/constants/Constants.html#MAX_USERID_LENGTH">Constants.MAX_USERID_LENGTH</a> long and the role has to be admin or timeAdmin.</dd>
</dl>
</li>
</ul>
<a name="removeUser-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>removeUser</h4>
<pre>public&nbsp;void&nbsp;removeUser(java.lang.String&nbsp;deleteUserId)
                throws <a href="../../../../../../../main/java/de/bsi/tsesimulator/exceptions/RemovingUserFailedException.html" title="class in main.java.de.bsi.tsesimulator.exceptions">RemovingUserFailedException</a></pre>
<div class="block">Removes a <a href="../../../../../../../main/java/de/bsi/tsesimulator/tse/usermanagement/User.html" title="class in main.java.de.bsi.tsesimulator.tse.usermanagement">User</a> from both the persistentStorageDir and the userlist.properties file. This method is only present for testing purposes.
 It does <b>not</b> check, whether any User(s) would be left after removing one. The caller has to make sure, that there still are users present for 
 the simulator to use.<br>
 If the user that shall be deleted does not exist, this method throws an exception.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>deleteUserId</code> - the user that shall be deleted</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../../../../../main/java/de/bsi/tsesimulator/exceptions/RemovingUserFailedException.html" title="class in main.java.de.bsi.tsesimulator.exceptions">RemovingUserFailedException</a></code> - if something happens during the removal process, for example, there is no user to delete.</dd>
</dl>
</li>
</ul>
<a name="loadUser-java.lang.String-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>loadUser</h4>
<pre>public&nbsp;<a href="../../../../../../../main/java/de/bsi/tsesimulator/tse/usermanagement/User.html" title="class in main.java.de.bsi.tsesimulator.tse.usermanagement">User</a>&nbsp;loadUser(java.lang.String&nbsp;userId)
              throws <a href="../../../../../../../main/java/de/bsi/tsesimulator/exceptions/LoadingFailedException.html" title="class in main.java.de.bsi.tsesimulator.exceptions">LoadingFailedException</a></pre>
<div class="block">This method loads a <a href="../../../../../../../main/java/de/bsi/tsesimulator/tse/usermanagement/User.html" title="class in main.java.de.bsi.tsesimulator.tse.usermanagement">User</a> from a file in the directory specified by persistentStorageDir in config.properties. 
 Loading a user will most likely occur whenever the <a href="../../../../../../../main/java/de/bsi/tsesimulator/tse/TSEController.html" title="class in main.java.de.bsi.tsesimulator.tse">TSEController</a> attempts to perform some kind of user related operation.
 Loading a user from a file is necessary for checking the stored PIN and/or PUK against the one provided to the TSEController.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>userId</code> - the ID of the user that shall be loaded. Calling method has to make sure the user id exists.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>a <a href="../../../../../../../main/java/de/bsi/tsesimulator/tse/usermanagement/User.html" title="class in main.java.de.bsi.tsesimulator.tse.usermanagement">User</a> constructed from the data on the file system</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../../../../../../main/java/de/bsi/tsesimulator/exceptions/LoadingFailedException.html" title="class in main.java.de.bsi.tsesimulator.exceptions">LoadingFailedException</a></code> - if something happens to the loading operation, for example the file does not exist or there are too many files with that user ID.</dd>
</dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/PersistentStorage.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../../../main/java/de/bsi/tsesimulator/tse/storage/PersistedValues.html" title="class in main.java.de.bsi.tsesimulator.tse.storage"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../../../../main/java/de/bsi/tsesimulator/tse/storage/Storage.html" title="class in main.java.de.bsi.tsesimulator.tse.storage"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../../../index.html?main/java/de/bsi/tsesimulator/tse/storage/PersistentStorage.html" target="_top">Frames</a></li>
<li><a href="PersistentStorage.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
